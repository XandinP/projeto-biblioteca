DROP TABLE EMPRESTIMO;

DROP TABLE ALUNO;

DROP TABLE LIVRO;

DROP SEQUENCE ID_EMPRESTIMO_SEQ;

DROP SEQUENCE ID_ALUNO_SEQ;

CREATE TABLE LIVRO(
    ISBN VARCHAR2(13) NOT NULL,
    TITULO VARCHAR2(255) NOT NULL,
    AUTOR VARCHAR2(100) NOT NULL,
    ANO NUMBER NOT NULL,
    CATEGORIA VARCHAR2(50),
    COPIAS_DISPONIVEIS NUMBER NOT NULL,
    CONSTRAINT LIVRO_PK PRIMARY KEY (ISBN)
);

CREATE TABLE ALUNO (
    ID NUMBER NOT NULL,
    TURMA VARCHAR2(10) NOT NULL,
    NOME VARCHAR2(100) NOT NULL,
    CONSTRAINT ALUNO_PK PRIMARY KEY (ID)
);

CREATE TABLE EMPRESTIMO (
    IDEMPRESTIMO NUMBER NOT NULL,
    DATAEMPRESTIMO DATE DEFAULT SYSDATE NOT NULL,
    DATADEVOLUCAO DATE,
    ISBN VARCHAR2(13) NOT NULL,
    ID_ALUNO NUMBER NOT NULL,
    CONSTRAINT EMPRESTIMO_PK PRIMARY KEY (IDEMPRESTIMO)
);

CREATE SEQUENCE ID_EMPRESTIMO_SEQ;

CREATE SEQUENCE ID_ALUNO_SEQ;

ALTER TABLE
    EMPRESTIMO
ADD
    CONSTRAINT ALUNO_EMPRESTIMO_FK FOREIGN KEY (ID_ALUNO) REFERENCES ALUNO (ID) NOT DEFERRABLE;

ALTER TABLE
    EMPRESTIMO
ADD
    CONSTRAINT LIVRO_EMPRESTIMO_FK FOREIGN KEY (ISBN) REFERENCES LIVRO (ISBN) NOT DEFERRABLE;